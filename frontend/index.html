<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –ú–æ—Å–∫–≤—ã</title>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1>üèõÔ∏è –ö—É–ª—å—Ç—É—Ä–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –ú–æ—Å–∫–≤—ã</h1>
            <nav class="header-nav">
                <div class="user-info">
                    <span>üë§ <span id="user-name"></span></span>
                    <button class="btn btn-secondary" id="logout-btn">–í—ã—Ö–æ–¥</button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <!-- Message -->
        <div id="message" class="message hidden"></div>

        <div class="main-layout">
            <!-- Sidebar -->
            <aside class="sidebar">
                <h2>–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞</h2>
                
                <div class="form-group">
                    <label><span class="ui-icon-wrap" aria-hidden="true">
                        <svg class="ui-icon" viewBox="0 0 24 24" focusable="false">
                            <path fill="currentColor" d="M12 2a7 7 0 0 0-7 7c0 5.25 7 13 7 13s7-7.75 7-13a7 7 0 0 0-7-7Zm0 9.5A2.5 2.5 0 1 1 12 6.5a2.5 2.5 0 0 1 0 5Z"/>
                        </svg>
                    </span>–¢–æ—á–∫–∞ —Å—Ç–∞—Ä—Ç–∞</label>
                    <small>–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–µ –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã</small>
                </div>

                <div class="form-group">
                    <label for="start-lat">–®–∏—Ä–æ—Ç–∞</label>
                    <input 
                        type="number" 
                        id="start-lat" 
                        step="0.000001" 
                        placeholder="55.7539"
                        readonly
                    >
                </div>

                <div class="form-group">
                    <label for="start-lon">–î–æ–ª–≥–æ—Ç–∞</label>
                    <input 
                        type="number" 
                        id="start-lon" 
                        step="0.000001" 
                        placeholder="37.6208"
                        readonly
                    >
                </div>

                <div class="form-group">
                    <label for="start-address">–ê–¥—Ä–µ—Å (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <input 
                        type="text" 
                        id="start-address" 
                        placeholder="–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"
                    >
                </div>

                <div class="form-group">
                    <label for="objects-count">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –º–∞—Ä—à—Ä—É—Ç–µ</label>
                    <input 
                        type="number" 
                        id="objects-count" 
                        min="2" 
                        max="20" 
                        value="5"
                    >
                    <small>–û—Ç 2 –¥–æ 20 –æ–±—ä–µ–∫—Ç–æ–≤ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–¥–∏—É—Å 5 –∫–º)</small>
                </div>

                <div class="action-block">
                    <button class="btn-build-route" id="build-route-btn">
                        üó∫Ô∏è –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç
                    </button>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-section-title">–ú–æ–∏ –º–∞—Ä—à—Ä—É—Ç—ã</h3>
                    <div id="routes-list" class="route-history"></div>
                </div>

                <div class="sidebar-section">
                    <p class="sidebar-help">
                        <strong>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:</strong><br>
                        1. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–æ—á–∫–∏ —Å—Ç–∞—Ä—Ç–∞<br>
                        2. –£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤<br>
                        3. –ù–∞–∂–º–∏—Ç–µ "–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç"
                    </p>
                </div>
            </aside>

            <!-- Map -->
            <main>
                <div id="map"></div>
                
                <!-- Route Results -->
                <div id="route-results" class="route-results hidden">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∞—Ä—à—Ä—É—Ç–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </main>
        </div>
    </div>

    <!-- AI Guide Modal -->
    <div id="ai-modal" class="modal hidden" aria-hidden="true">
        <div class="modal-backdrop" id="ai-modal-backdrop"></div>
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="ai-modal-title">
            <div class="modal-header">
                <div>
                    <div class="modal-kicker">–ò–ò‚Äë—ç–∫—Å–∫—É—Ä—Å–æ–≤–æ–¥</div>
                    <h3 id="ai-modal-title" class="modal-title"></h3>
                </div>
                <button class="modal-close" id="ai-modal-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
            </div>
            <div id="ai-modal-body" class="modal-body"></div>
        </div>
    </div>

    <!-- Frontend local config (–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å). –°–æ–∑–¥–∞–π—Ç–µ –∏–∑ js/config.example.js -->
    <script src="js/config.js"></script>

    <!-- Custom JS (API –∫–ª–∏–µ–Ω—Ç –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—Ä—Ç—ã) -->
    <script src="js/api.js"></script>

    <!-- Yandex Maps JS API (–∫–ª—é—á –±–µ—Ä—ë–º –∏–∑ js/config.js), –∑–∞—Ç–µ–º –ø–æ–¥–≥—Ä—É–∂–∞–µ–º map.js -->
    <script>
        (function () {
            const messageDiv = document.getElementById('message');
            const key = window.APP_CONFIG && window.APP_CONFIG.YANDEX_MAPS_API_KEY;

            if (!key) {
                const text = '–ù–µ –∑–∞–¥–∞–Ω –∫–ª—é—á Yandex Maps. –°–æ–∑–¥–∞–π—Ç–µ js/config.js (—Å–º. js/config.example.js).';
                console.error(text);
                if (messageDiv) {
                    messageDiv.className = 'message message-error';
                    messageDiv.textContent = text;
                    messageDiv.classList.remove('hidden');
                }
                return;
            }

            const yandex = document.createElement('script');
            yandex.src = 'https://api-maps.yandex.ru/2.1/?apikey=' + encodeURIComponent(key) + '&lang=ru_RU';
            yandex.async = true;

            yandex.onload = function () {
                const mapScript = document.createElement('script');
                mapScript.src = 'js/map.js';
                mapScript.defer = true;
                document.body.appendChild(mapScript);
            };

            yandex.onerror = function () {
                const text = '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–ª—é—á –∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–¥–æ—Å—Ç—É–ø.';
                console.error(text);
                if (messageDiv) {
                    messageDiv.className = 'message message-error';
                    messageDiv.textContent = text;
                    messageDiv.classList.remove('hidden');
                }
            };

            document.head.appendChild(yandex);
        })();
    </script>
</body>
</html>

